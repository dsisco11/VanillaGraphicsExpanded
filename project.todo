Headless OpenGL Shader Test Fixture:

  Phase 1 - Project Setup:
    ✔ Add Silk.NET.Windowing NuGet package to VanillaGraphicsExpanded.Tests.csproj @done
    ✔ Add Silk.NET.GLFW NuGet package to VanillaGraphicsExpanded.Tests.csproj @done
    ✔ Upgrade from xUnit 2.x to xUnit v3 (xunit.v3) for SkipException support @done
    ✔ Add <Content Include> directive to copy shader assets to test output directory @done
    ✔ Add <Content Include> directive to copy shaderincludes to test output directory @done

  Phase 2 - Test Infrastructure:
    ✔ Create GPU/ subfolder in VanillaGraphicsExpanded.Tests/ @done
    ✔ Create GPU/Fixtures/ subfolder for test fixtures @done
    ✔ Create GPU/Helpers/ subfolder for test utilities @done
    ✔ Implement HeadlessGLFixture in GPU/Fixtures/HeadlessGLFixture.cs @done
      ✔ Implement IAsyncLifetime interface @done
      ✔ Create hidden GLFW window with OpenGL 4.3 context in InitializeAsync() @done
      ✔ Throw SkipException if context creation fails (no GPU, driver issues) @done
      ✔ Expose IsContextValid property @done
      ✔ Dispose window in DisposeAsync() @done
    ✔ Implement ShaderTestHelper in GPU/Helpers/ShaderTestHelper.cs @done
      ✔ Constructor accepts explicit shaderBasePath and includeBasePath parameters @done
      ✔ CompileShader(string filename, ShaderType type) method with error extraction @done
      ✔ LinkProgram(uint vertexShader, uint fragmentShader) method with error extraction @done
      ✔ Integrate @import directive resolution for include files @done

  Phase 3 - Shader Compilation Tests:
    ✔ Create GPU/LumOnShaderCompilationTests.cs @done
    ✔ Add [Trait("Category", "GPU")] to test class @done
    ✔ Inject HeadlessGLFixture via IClassFixture<T> @done
    ✔ Add [Theory] tests for each shader pair: @done
      ✔ lumon_probe_anchor.vsh / lumon_probe_anchor.fsh @done
      ✔ lumon_probe_trace.vsh / lumon_probe_trace.fsh @done
      ✔ lumon_probe_trace_octahedral.vsh / lumon_probe_trace_octahedral.fsh @done
      ✔ lumon_temporal.vsh / lumon_temporal.fsh @done
      ✔ lumon_temporal_octahedral.vsh / lumon_temporal_octahedral.fsh @done
      ✔ lumon_gather.vsh / lumon_gather.fsh @done
      ✔ lumon_gather_octahedral.vsh / lumon_gather_octahedral.fsh @done
      ✔ lumon_upsample.vsh / lumon_upsample.fsh @done
      ✔ lumon_combine.vsh / lumon_combine.fsh @done
      ✔ lumon_debug.vsh / lumon_debug.fsh @done
    ✔ Assert compilation success with clear error messages on failure @done
    ✔ Assert link success with clear error messages on failure @done

  Phase 4 - Uniform Validation Tests:
    ✔ Create GPU/LumOnUniformTests.cs @done
    ✔ Add [Trait("Category", "GPU")] to test class @done
    ✔ Use [MemberData] to provide expected uniform lists per shader @done
    ✔ Verify GL.GetUniformLocation >= 0 for each expected uniform @done
    ✔ Document expected uniforms per shader: @done
      ✔ lumon_probe_anchor: primaryDepth, gBufferNormal, invProjectionMatrix, invViewMatrix, probeSpacing, screenSize, zNear, zFar, depthDiscontinuityThreshold @done
      ✔ lumon_probe_trace: probeAnchorPosition, probeAnchorNormal, primaryDepth, primaryColor, invProjectionMatrix, projectionMatrix, viewMatrix, probeGridSize, frameIndex, raysPerProbe, raySteps, rayMaxDistance, rayThickness, skyMissWeight, sunPosition, sunColor, ambientColor @done
      ✔ lumon_temporal: radianceCurrent0, radianceCurrent1, radianceHistory0, radianceHistory1, probeAnchorPosition, probeAnchorNormal, historyMeta, viewMatrix, prevViewProjMatrix, probeGridSize, temporalAlpha, depthRejectThreshold, normalRejectThreshold @done
      ✔ lumon_gather: radianceTexture0, radianceTexture1, probeAnchorPosition, probeAnchorNormal, primaryDepth, gBufferNormal, invProjectionMatrix, viewMatrix, probeSpacing, probeGridSize, screenSize, halfResSize, intensity, indirectTint, depthSigma, normalSigma @done
      ✔ lumon_upsample: indirectHalf, primaryDepth, gBufferNormal, screenSize, halfResSize, zNear, zFar, denoiseEnabled, upsampleDepthSigma, upsampleNormalSigma @done
      ✔ lumon_combine: sceneDirect, indirectDiffuse, gBufferAlbedo, gBufferMaterial, primaryDepth, indirectIntensity, indirectTint, lumOnEnabled @done

  Phase 5 - Render Test Infrastructure:
    ✔ Create GPU/Fixtures/RenderTestBase.cs abstract base class @done
    ✔ Use existing DynamicTexture class for RGBA16F render targets @done
    ✔ Use existing GBuffer class for FBO setup @done
    ✔ Implement CreateRenderTarget(int width, int height, PixelInternalFormat format) helper @done
    ✔ Implement RenderFullscreenQuad(int programId) helper @done
    ✔ Implement ReadPixels<T>(GBuffer fbo) helper for pixel verification @done
    ✔ Add fullscreen quad VAO setup/teardown @done

  Phase 6 - Documentation:
    ✔ Add "Testing" section to README.md @done
    ✔ Document: dotnet test --filter "Category!=GPU" (CI without GPU) @done
    ✔ Document: dotnet test --filter "Category=GPU" (GPU-only tests) @done
    ✔ Document: dotnet test (all tests locally) @done
    ✔ Document LIBGL_ALWAYS_SOFTWARE=1 for Mesa llvmpipe on Linux CI @done

  Phase 7 - GLSL AST Uniform Extraction:
    ✔ Upgrade to the latest TinyTokenizer package for Keywords support (0.10.0). @done
    ✔ Extend GlslSchema to recognize GLSL data-type keywords: @done
      ✔ Scalar types: float, int, uint, bool, double @done
      ✔ Vector types: vec2, vec3, vec4, ivec2, ivec3, ivec4, uvec2, uvec3, uvec4, bvec2, bvec3, bvec4, dvec2, dvec3, dvec4 @done
      ✔ Matrix types: mat2, mat3, mat4, mat2x3, mat2x4, mat3x2, mat3x4, mat4x2, mat4x3 @done
      ✔ Sampler types: sampler2D, sampler3D, samplerCube, sampler2DArray, sampler2DShadow, samplerCubeShadow, isampler2D, usampler2D, etc. @done
      ✔ Image types: image2D, image3D, imageCube, etc. (for compute shaders) @done
    ✔ Define GlUniformNode syntax in GlslSchema: @done
      ✔ Pattern: "uniform" <type> <identifier> [array-brackets]? ";" @done
      ✔ Support array declarations: uniform vec4 myArray[16]; @done
      ✔ Extract uniform name, type, and optional array size @done
    ✔ Create GlUniformNode AST node class: @done
      ✔ Properties: Name (string), TypeName (string), ArraySize (int?) @done
      ✔ ToString() for debugging @done
    ✔ Implement UniformExtractor utility: @done
      ✔ Method: ExtractUniforms(SyntaxTree tree) -> IEnumerable<UniformDeclaration> @done
      ✔ Query tree for all GlUniformNode instances @done
      ✔ Return deduplicated list of uniform declarations @done
    ✔ Fix Query pattern matching for uniform extraction: @done
      ✔ Use Query.Sequence() wrapper for all syntax patterns @done
      ✔ Use Query.AnyOf() for alternation in patterns @done
      ✔ Filter "uniform" keyword text in UniformExtractor to exclude "in", "out", etc. @done
    ✔ Refactor LumOnUniformTests to use AST extraction: @done
      ✔ Extract expected uniforms from shader source via AST @done
      ✔ Compare AST-declared uniforms against GL.GetUniformLocation results @done
      ✔ Report which declared uniforms were optimized out vs missing @done
      ✔ Remove manually maintained TheoryData uniform lists @done

Future Enhancements:
  ☐ Add sample pixel-level render test (SH encode/decode roundtrip via lumon_sh.glsl)
  ☐ Add performance benchmarks for shader compilation
  ☐ Add GPU capability detection and conditional test skipping per feature
