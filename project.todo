Headless OpenGL Shader Test Fixture:

  Phase 1 - Project Setup:
    ✔ Add Silk.NET.Windowing NuGet package to VanillaGraphicsExpanded.Tests.csproj @done
    ✔ Add Silk.NET.GLFW NuGet package to VanillaGraphicsExpanded.Tests.csproj @done
    ✔ Upgrade from xUnit 2.x to xUnit v3 (xunit.v3) for SkipException support @done
    ✔ Add <Content Include> directive to copy shader assets to test output directory @done
    ✔ Add <Content Include> directive to copy shaderincludes to test output directory @done

  Phase 2 - Test Infrastructure:
    ☐ Create GPU/ subfolder in VanillaGraphicsExpanded.Tests/
    ☐ Create GPU/Fixtures/ subfolder for test fixtures
    ☐ Create GPU/Helpers/ subfolder for test utilities
    ☐ Implement HeadlessGLFixture in GPU/Fixtures/HeadlessGLFixture.cs
      ☐ Implement IAsyncLifetime interface
      ☐ Create hidden GLFW window with OpenGL 4.3 context in InitializeAsync()
      ☐ Throw SkipException if context creation fails (no GPU, driver issues)
      ☐ Expose IsContextValid property
      ☐ Dispose window in DisposeAsync()
    ☐ Implement ShaderTestHelper in GPU/Helpers/ShaderTestHelper.cs
      ☐ Constructor accepts explicit shaderBasePath and includeBasePath parameters
      ☐ CompileShader(string filename, ShaderType type) method with error extraction
      ☐ LinkProgram(int vertexShader, int fragmentShader) method with error extraction
      ☐ Integrate GlslSourcePreProcessor.ProcessIncludes() for #include resolution

  Phase 3 - Shader Compilation Tests:
    ☐ Create GPU/LumOnShaderCompilationTests.cs
    ☐ Add [Trait("Category", "GPU")] to test class
    ☐ Inject HeadlessGLFixture via IClassFixture<T>
    ☐ Add [Theory] tests for each shader pair:
      ☐ lumon_probe_anchor.vsh / lumon_probe_anchor.fsh
      ☐ lumon_probe_trace.vsh / lumon_probe_trace.fsh
      ☐ lumon_probe_trace_octahedral.vsh / lumon_probe_trace_octahedral.fsh
      ☐ lumon_temporal.vsh / lumon_temporal.fsh
      ☐ lumon_temporal_octahedral.vsh / lumon_temporal_octahedral.fsh
      ☐ lumon_gather.vsh / lumon_gather.fsh
      ☐ lumon_gather_octahedral.vsh / lumon_gather_octahedral.fsh
      ☐ lumon_upsample.vsh / lumon_upsample.fsh
      ☐ lumon_combine.vsh / lumon_combine.fsh
      ☐ lumon_debug.vsh / lumon_debug.fsh
    ☐ Assert compilation success with clear error messages on failure
    ☐ Assert link success with clear error messages on failure

  Phase 4 - Uniform Validation Tests:
    ☐ Create GPU/LumOnUniformTests.cs
    ☐ Add [Trait("Category", "GPU")] to test class
    ☐ Use [MemberData] to provide expected uniform lists per shader
    ☐ Verify GL.GetUniformLocation >= 0 for each expected uniform
    ☐ Document expected uniforms per shader:
      ☐ lumon_probe_anchor: primaryDepth, gBufferNormal, invViewMatrix, probeSpacing, screenSize, zNear, zFar
      ☐ lumon_probe_trace: probeAnchorPosition, probeAnchorNormal, primaryDepth, primaryColor, viewMatrix, raysPerProbe, raySteps, rayMaxDistance
      ☐ lumon_temporal: radianceCurrent0, radianceCurrent1, radianceHistory0, radianceHistory1, probeAnchorPosition, probeAnchorNormal, historyMeta, temporalAlpha, depthRejectThreshold
      ☐ lumon_gather: radianceTexture0, radianceTexture1, probeAnchorPosition, probeAnchorNormal, primaryDepth, gBufferNormal, viewMatrix, probeGridSize, halfResSize, depthSigma, normalSigma
      ☐ lumon_upsample: indirectHalf, primaryDepth, gBufferNormal, screenSize, halfResSize, upsampleDepthSigma, upsampleNormalSigma
      ☐ lumon_combine: sceneDirect, indirectDiffuse, gBufferAlbedo, gBufferMaterial, primaryDepth, indirectIntensity, indirectTint

  Phase 5 - Render Test Infrastructure:
    ☐ Create GPU/Fixtures/RenderTestBase.cs abstract base class
    ☐ Use existing DynamicTexture class for RGBA16F render targets
    ☐ Use existing GBuffer class for FBO setup
    ☐ Implement CreateRenderTarget(int width, int height, PixelInternalFormat format) helper
    ☐ Implement RenderFullscreenQuad(int programId) helper
    ☐ Implement ReadPixels<T>(GBuffer fbo) helper for pixel verification
    ☐ Add fullscreen quad VAO setup/teardown

  Phase 6 - Documentation:
    ☐ Add "Testing" section to README.md
    ☐ Document: dotnet test --filter "Category!=GPU" (CI without GPU)
    ☐ Document: dotnet test --filter "Category=GPU" (GPU-only tests)
    ☐ Document: dotnet test (all tests locally)
    ☐ Document LIBGL_ALWAYS_SOFTWARE=1 for Mesa llvmpipe on Linux CI

Future Enhancements:
  ☐ Add sample pixel-level render test (SH encode/decode roundtrip via lumon_sh.glsl)
  ☐ Add performance benchmarks for shader compilation
  ☐ Add GPU capability detection and conditional test skipping per feature
